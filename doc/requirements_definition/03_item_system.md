# 要件定義書: 03_アイテムとインベントリシステム

## 概要
この文書は、ローグライクRPG開発の第三のマイルストーンである「アイテムとインベントリシステム」の要件を定義する。

## 完了目標
-   プレイヤーはマップ上に落ちているアイテムを拾うことができる。
-   プレイヤーはインベントリ（持ち物）を開いて、所持アイテムを確認できる。
-   プレイヤーはアイテムを使用できる（例：ポーションを飲んでHPを回復）。
-   プレイヤーは武器や防具を装備・装備解除でき、ステータスが変化する。

## 実行計画 (チェックリスト)
- [ ] **データ定義とInfrastructure層**
    - [ ] `assets/items.json` を作成し、ポーション、武器、防具の基本データを定義する。
    - [ ] `GameLoop` が起動時にアイテムデータを読み込むようにする。
- [ ] **Domain層**
    - [ ] アイテム関連コンポーネントを `ecs/components.py` に追加する。
        - [ ] `ItemComponent` (アイテムマーカー)
        - [ ] `ConsumableComponent` (消費可能アイテム)
        - [ ] `EquippableComponent` (装備可能アイテム)
        - [ ] `InventoryComponent` (持ち物リスト)
        - [ ] `EquipmentComponent` (装備状態)
    - [ ] `factories.py` に `create_item` 関数を追加する。
    - [ ] `mapgen.py` に、マップの空きスペースにアイテムを配置するロジックを追加する。
- [ ] **Application層**
    - [ ] `GameLoop` にゲームの状態を管理する `GameState` (Enum) を導入する。
    - [ ] アイテムを拾う `pickup_service` を実装する。
    - [ ] アイテムを使用する `use_item_service` を実装する。
    - [ ] アイテムを装備/解除する `equip_item_service` を実装する。
    - [ ] `GameLoop` を更新し、状態に応じたキー入力 (`g`で拾う, `i`でインベントリ表示など) を処理できるようにする。
- [ ] **Presentation層**
    - [ ] `DungeonRenderer` がマップ上のアイテムを描画するように更新する。
    - [ ] インベントリ表示用のUI画面を `presentation/inventory_screen.py` に実装する。
    - [ ] `main.py` と `DungeonRenderer` を更新し、`GameState` に応じて適切な画面を描画するようにする。
- [ ] **テスト**
    - [ ] アイテムを拾う、使う、装備する各サービスのロジックをテストする。
    - [ ] 装備によってステータスが正しく変動するかをテストする。
- [ ] **ドキュメント**
    - [ ] `README.md` に、アイテム操作に関する説明を追記する。